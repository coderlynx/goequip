<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Outlet Gym</title>
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<link rel="stylesheet" href="css/normalize.css" />
	<link rel="stylesheet" href="css/normalize.min.css">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<script src="js/lib/modernizr-2.8.3-respond-1.4.2.min.js"></script>

	<!-- Google Font -->
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>

	<!-- Font Awesome -->
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

    <!-- Estilos -->
	<link rel="stylesheet" href="css/estilos.css">

</head>
<body>
	<!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

    <main>
    <div class="contenedor">
    	<header id="header">
    		
    	</header>

	    <nav id="nav" class="navbar navbar-default">
		  
		</nav>

	<!-- /.CATEGORIA -->
	<div class="contenedor carrito">	
		<div class="container-fluid">
		<div class="row text-center">
			<h1><i class="fa fa-shopping-cart" aria-hidden="true"></i> Tu carrito</h1>
		</div>
		<section class="row">
			<div id="contenedorDetalleCarro" class="col-lg-5 col-md-5 col-sm-6 col-xs-12 col-lg-offset-1 col-md-offset-1 detalle-compra">
				<h2>Productos seleccionados (<span id="cantidadProductosSeleccionados"></span>)</h2>
<!--
				<article>
					<div class="info-detalle-compra"><img src="img/productos/a1home.jpg" alt=" "></div>
					<div class="info-detalle-compra">
						<h3>Waterrower A1 Home <span class="detalle-items">$31.900</span></h3>
						<p><span class="detalle-items">Color:</span> Negro</p>
						<p><span class="detalle-items">Talla:</span> S</p>
						<p><span class="detalle-items">Cantidad:</span> 1</p>
						<a href="">Editar</a>
						<a href="">Eliminar</a>
					</div>
				</article>
				<article>
					<div class="info-detalle-compra"><img src="img/productos/a1home.jpg" alt=" "></div>
					<div class="info-detalle-compra">
						<h3>Waterrower A1 Home <span class="detalle-items">$31.900</span></h3>
						<p><span class="detalle-items">Color:</span> Negro</p>
						<p><span class="detalle-items">Talla:</span> S</p>
						<p><span class="detalle-items">Cantidad:</span> 1</p>
						<a href="">Editar</a>
						<a href="">Eliminar</a>
					</div>
				</article>
				<article>
					<div class="info-detalle-compra"><img src="img/productos/a1home.jpg" alt=" "></div>
					<div class="info-detalle-compra">
						<h3>Waterrower A1 Home <span class="detalle-items">$31.900</span></h3>
						<p><span class="detalle-items">Color:</span> Negro</p>
						<p><span class="detalle-items">Talla:</span> S</p>
						<p><span class="detalle-items">Cantidad:</span> 1</p>
						<a href="">Editar</a>
						<a href="">Eliminar</a>
					</div>
				</article>
-->
			</div>

			<div class="col-lg-5 col-md-5 col-sm-6 col-xs-12 detalle-carrito">
				<article id="formaEnvio" class="detalle-carrito-resumen">
					<h2><i class="fa fa-truck" aria-hidden="true"></i> Envío:</h2>
					<div class="row">
						<div class="col-lg-9 col-sm-9 col-xs-9">
						    <p class="formaDeEntrega">Retiro personalmente</p>
				        </div>
				        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-right">
				            <label>$ <span>0</span> <input value="1" type="radio" name="optradio"></label>
				        </div>
				        
						<div class="col-lg-9 col-sm-9 col-xs-9">
						    <p class="formaDeEntrega">Capital Federal</p>
				        </div>
				        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-right">
				            <label>$ <span>100</span> <input value="2" type="radio" name="optradio"></label>
				        </div>
				        
						<div class="col-lg-9 col-sm-9 col-xs-9">
						    <p class="formaDeEntrega">Gran Buenos Aires</p>
				        </div>
				        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-right">
				            <label>$ <span>120</span> <input value="3" type="radio" name="optradio"></label>
				        </div>
				        
						<div class="col-lg-9 col-sm-9 col-xs-9">
						    <p class="formaDeEntrega">NOA</p>
						</div>
						<div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-right">
						    <label>$ <span>200</span> <input value="4" type="radio" name="optradio"></label>
						</div>
						
						<div class="col-lg-9 col-sm-9 col-xs-9">
						    <p class="formaDeEntrega">Chaco</p>
						</div>
						<div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-right">
						    <label>$ <span>200</span> <input value="5" type="radio" name="optradio"></label>
						</div>
						
						<div class="col-lg-9 col-sm-9 col-xs-9">
						    <p class="formaDeEntrega">Mesopotamia</p>
						</div>
						<div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-right">
						    <label>$ <span>200</span> <input value="6" type="radio" name="optradio"></label>
						</div>
						<div class="col-lg-9 col-sm-9 col-xs-9">
						    <p class="formaDeEntrega">Cuyo</p>
						</div>
						<div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-right">
						    <label>$ <span>300</span> <input value="7" type="radio" name="optradio"></label>
						</div>
						
					</div>
				</article>
			</div>
			<div class="col-lg-5 col-md-5 col-sm-6 col-xs-12 detalle-carrito">
				<article class="detalle-carrito-resumen">
					<h2><i class="fa fa-shopping-cart" aria-hidden="true"></i> Resúmen de tu compra:</h2>
					<div class="row">
					<div class="col-lg-9 col-sm-9 col-xs-9"><p><span class="detalle-items">Cantidad:</span></p></div>
					<div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-right"><p><span class="totalCantidad">0</span</p></div>

					<div class="col-lg-9 col-sm-9 col-xs-9"><p><span class="detalle-items">Total parcial:</span></p></div>
					<div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-right"><p>$ <span class="totalPedido">0</span></p></div>

					<div class="col-lg-9 col-sm-9 col-xs-9"><p><span class="detalle-items">Envío:</span></p></div>
					<div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-right"><p> $ <span class="totalEnvio" id="valorEnvio">0</span></p></div>

					<div class="col-lg-9 col-sm-9 col-xs-9"><p><span class="detalle-items">Total + envio:</span></p></div>
                        <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-right"><p class="precio"> $ <span class="totalPedidoFinal">0</span></p></div>
					</div>
					<div class="row text-center div-comprar">
						<div>
                        <div class="mensajes" id="mensaje"></div>
                        <button id="comprarMP" class="btn btn-default btn-comprar">
						    <i class="fa fa-money" aria-hidden="true"></i> Pagar con <span class="detalle-items">Mercado Pago</span>
						   </button> 
						  </div>
						<div><a class="btn btn-default btn-comprar" href="#" role="button"><i class="fa fa-paypal" aria-hidden="true"></i> Pagar con <span class="detalle-items">Paypal (aún no disponible)</span></a></div>
					</div>
					<label class="">
                        <input id="terminos" type="checkbox" required="required">
                        Acepto los <span><a href="Terminos.php">términos y condiciones</a></span> de la compra.
                    </label>
				</article>
			</div>
		</section>
		</div>
	</div>


	<!-- /.DESTACADOS -->	
	<section id="destacados">
		
	</section><!-- /.Fin destacados -->
    </div><!-- /.contenedor global -->
    
	<footer id="footer" class="pie">
		
	</footer>

	
	<script src="js/lib/jquery.js"></script>
	<!--<script src="http://code.jquery.com/jquery-latest.js"></script><!-->
	<script src="js/lib/bootstrap.min.js"></script>
	<script src="js/lib/jquery.number.min.js"></script>
	<script src="js/Producto.js"></script>
	<script src="js/Carrito.js"></script>
	<script src="js/Autenticacion.js"></script>
	<script>
		$( document ).ready(function() {
            
             //codigo repetido extraido
             $( "#header" ).load( "codigoComun.php #header", function() {
                Carrito.init();
                Autenticacion.init();
             }); 
            
              $( "#nav" ).load( "codigoComun.php #nav", function() {
               Producto.bindearBuscadorProductos();
             } );
             $( "#footer" ).load( "codigoComun.php #footer" );
             $( "#destacados" ).load( "codigoComun.php #destacados" );

            
            //temporal en este lugar
            $("#comprarMP").click(function() {
                
                if (!$("#terminos").is(':checked')) {
                        $('#mensaje').html('Debe aceptar los terminos y condiciones para continuar');
                        return;
                    }
                    
                    if (!$('input[name=optradio]:checked', '#formaEnvio').val()) {
                         $('#mensaje').html('Debe seleccionar forma de entrega');
                        return;
                    }
             
                    
                    $.ajax({
                      async:false,    
                      cache:false,   
                      type: 'POST', 
                      data: {pagar:true },
                      url: "php/controllerCarrito.php",
                      success:  function(respuestaJson){
                        if (respuestaJson == 'ok') {
                            window.location.href = 'datosTitular.php';
                            return;
                            }
                            alert(respuestaJson);
                      },
                      error:function(objXMLHttpRequest){
                           console.log('Error al ejecutar la petición por:' + e);
                      }
                    });//fin btnComprar
               
		});
        
        
            //temporal en este lugar
            $("#formaEnvio input").change(function() {

                    var envio = {
                        idLugar: $('input[name=optradio]:checked', '#formaEnvio').val(),
                        nombreLugar: $('input[name=optradio]:checked', '#formaEnvio').parent().parent().prev().children().html(),
                        costo: $('input[name=optradio]:checked', '#formaEnvio').prev().html()
                    }
                    
                    var envioJson = JSON.stringify(envio);
                    /*if(!radioFormaDeEntrega) {
                        alert("Debe seleccionar una forma de entrega");
                        return;
                    }*/

                    $.post('php/controllerPedido.php', {formaDeEntrega:envioJson}, function(respuesta) {
                        //var rta = JSON.parse(respuestaJson);
                        if(respuesta == 'ok') {
                            Carrito.getTotal();
                        } else {
                            alert(respuesta);
                        }
                            
                        

                    }).error(function(e){
                            console.log('Error al ejecutar la petición por:' + e);
                        }
                    );
               
                
                //$("#valorEnvio").html(envio.costo);
 

		  });
        });
  
        function getUrlParameter(sParam) {
            var sPageURL = decodeURIComponent(window.location.search.substring(1)),
                sURLVariables = sPageURL.split('&'),
                sParameterName,
                i;

            for (i = 0; i < sURLVariables.length; i++) {
                sParameterName = sURLVariables[i].split('=');

                if (sParameterName[0] === sParam) {
                    return sParameterName[1] === undefined ? true : sParameterName[1];
                }
            }
        };

        
	
	</script>	
</body>
</html>